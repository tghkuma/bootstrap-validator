var e={d:(s,t)=>{for(var r in t)e.o(t,r)&&!e.o(s,r)&&Object.defineProperty(s,r,{enumerable:!0,get:t[r]})},o:(e,s)=>Object.prototype.hasOwnProperty.call(e,s)},s={};e.d(s,{I:()=>n});const t={VALIDATE_ERROR:"入力に誤りがあります.",REQUIRED:"必須項目です.",REQUIRED_PART:"{0} は必須項目です.",INSUFFICIENT:"不足しています.",INSUFFICIENT_PART:"{0} が不足しています.",CONFIRM:"確認{0}と異なっています.",CONFIRM_FIELD:"項目",NUMERICAL_VALUE:"数値を入力して下さい.",INTEGER:"整数値を入力して下さい.",INTEGER_PART:"{0} は整数値を入力して下さい.",MIN:"{0} ～ の数値を入力してください.",MAX:"～ {0} の数値を入力してください.",RANGE:"{0} ～ {1} の数値を入力してください.",MIN_LENGTH:"{0}文字以上で入力して下さい.",MAX_LENGTH:"{0}文字以下で入力して下さい.",NUM_LENGTH:"{0}桁の数値を入力してください.",CHECKBOX_MIN:"{0} 個チェックしてください.",CHECKBOX_RANGE:"{0}～{1} 個の間でチェックしてください.",ZENKAKU:"全角で入力してください.",HANKAKU:"半角で入力してください.",ZEN_KANA:"全角カタカナで入力してください.",HIRAGANA:"ひらがなで入力してください.",TEL:"数値-()で入力してください.",ZIP:"[nnn-nnnn]書式で記述してください.",DATE:"[YYYY/MM/DD]書式で記述してください.",DATE_EX:"[YYYY/MM/DD] or [YYYY/MM] or [YYYY]書式で記述してください.",DATETIME:"[YYYY/MM/DD hh:mm:ss]書式で記述してください.",TIME:"[hh:mm:ss]書式で記述してください.",TIME_HM:"[hh:mm:ss]書式で記述してください.",DATE_INVALID:"日付が間違っています.",TIME_INVALID:"時間が間違っています.",DATE_PART_Y:"(年)",DATE_PART_M:"(月)",DATE_PART_D:"(日)",REGEXP_INVALID_PARAM:"正規表現が間違っています.",REGEXP_INVALID_VALUE:"書式が間違っています.",MAIL_NO_AT:"正しくありません(@).",MAIL_INVALID_IP:"正しくありません(IP).",MAIL_NO_DOMAIN:"ドメイン名がありません(DOMAIN).",MAIL_INVALID_LOCALE:"正しくありません(LOCALE).",MAIL_INVALID_DOMAIN:"ドメイン名の書式が誤っています.",NOT_EXISTS_FIELD:"フィールド名[{0}]が存在しません."};class r{static getValue(e){const s=e[0].attributes.type?e[0].attributes.type.value:null;let t;return"radio"===s?e.forEach((e=>{if(e.checked)return t=e.value,!0})):"checkbox"!==s?t=e[0].value:(t=[],e.forEach((e=>{e.checked&&t.push(e.value)}))),t}static existsValue(e){if(!e||0===e.length)return!1;let s;return"checkbox"===(e[0].attributes.type?e[0].attributes.type.value:null)?(s=!1,e.forEach((e=>{if(e.checked)return s=!0,!0}))):s=!!this.getValue(e),s}static pushErrors(e,s,t){const r=s.label?s.label:s.name;return"string"==typeof t&&t?e.push({name:s.name,label:r,message:t}):Array.isArray(t)&&t.forEach((t=>{e.push({name:s.name,label:r,message:t})})),e}static join(e,s){void 0===s&&(s="\n");const t=[];return e.forEach((e=>{"string"==typeof e&&e?t.push(e):t.push((e.label?e.label:e.name)+" : "+e.message)})),t.join(s)}static format(...e){return e.reduce(((e,s,t)=>e.replace(new RegExp("\\{"+(t-1)+"}","g"),s)))}static isHankaku(e){return!/[^\x20-\x7E]/.test(e)}static isZenkaku(e){return!/[\w\-.]/.test(e)}static isTel(e){return!/[^0-9-()]/.test(e)}static isInteger(e){return/^(-\d+|\d*)$/.test(""+e)&&!isNaN(e)}static isDate(e,s,t){if(e<1900||e>9999)return!1;if(s<1||s>12)return!1;if(t<1)return!1;const r=[31,28,31,30,31,30,31,31,30,31,30,31];return(e%4==0&&e%100!=0||e%400==0)&&(r[1]=29),!(r[s-1]<t)}static isTime(e,s,t){return!(e<0||e>=24||s<0||s>=60||null!==t&&(t<0||t>=60))}static isAllKana(e){for(let s=0;s<e.length;s++)if((e.charAt(s)<"ァ"||e.charAt(s)>"ヶ")&&"ー"!==e.charAt(s)&&" "!==e.charAt(s)&&"　"!==e.charAt(s))return!1;return!0}static isAllHiragana(e){for(let s=0;s<e.length;s++)if((e.charAt(s)<"ぁ"||e.charAt(s)>"ん")&&"ー"!==e.charAt(s)&&" "!==e.charAt(s)&&"　"!==e.charAt(s))return!1;return!0}static isEmailEx(e){const s='[^\\s\\(\\)<>@,;:\\\\\\"\\.\\[\\]]+',t=new RegExp("^"+s+"(\\."+s+")*$"),r=e.match(/^(.+)@(.+)$/);if(null===r)return this.settings.messages.MAIL_NO_AT;const i=r[2];if(null===i.match(t))return this.settings.messages.MAIL_NO_DOMAIN;const a=new RegExp(s,"g"),n=i.match(a),l=n.length;return n[n.length-1].length<2||n[n.length-1].length>4||l<2?this.settings.messages.MAIL_INVALID_LOCALE:""}}class i{static confirm(e,s,t,r){const i=r.querySelectorByName(e.name+r.settings.confirm_suffix);return s&&i&&0!==i.length&&r.helpers.getValue(s)===r.helpers.getValue(i)?null:r.helpers.format(r.settings.messages.CONFIRM,e.label?e.label:r.settings.messages.CONFIRM_FIELD)}static email(e,s,t,r){const i=r.helpers.getValue(s);if(i){const e=r.helpers.isEmailEx.apply(r,[i]);if(""!==e)return e}return null}static zenkaku(e,s,t,r){return r.helpers.isZenkaku(r.helpers.getValue(s))?null:r.settings.messages.ZENKAKU}static hankaku(e,s,t,r){return r.helpers.isHankaku(r.helpers.getValue(s))?null:r.settings.messages.HANKAKU}static zen_katakana(e,s,t,r){return r.helpers.isAllKana(r.helpers.getValue(s))?null:r.settings.messages.ZEN_KANA}static hiragana(e,s,t,r){return r.helpers.isAllHiragana(r.helpers.getValue(s))?null:r.settings.messages.HIRAGANA}static tel(e,s,t,r){return r.helpers.isTel(r.helpers.getValue(s))?null:r.settings.messages.TEL}static numeric(e,s,t,r){const i=r.helpers.getValue(s);return isFinite(i)&&-1===i.indexOf(" ")&&-1===i.indexOf("0x")?null:r.settings.messages.NUMERICAL_VALUE}static minlength(e,s,t,r){const i=Number(t[0]);return r.helpers.getValue(s).length<i?r.helpers.format(r.settings.messages.MIN_LENGTH,i):null}static maxlength(e,s,t,r){const i=Number(t[0]);return i<r.helpers.getValue(s).length?r.helpers.format(r.settings.messages.MAX_LENGTH,i):null}static numlength(e,s,t,r){const i=r.helpers.getValue(s);let a=t[0],n=t[0];return t[1]&&(a+=","+t[1],n+="～"+t[1]),new RegExp("^\\d{"+a+"}$").test(i)?null:r.helpers.format(r.settings.messages.NUM_LENGTH,n)}static min(e,s,t,r){const i=r.helpers.getValue(s);if(!r.helpers.isInteger(i))return r.settings.messages.INTEGER;const a=Number(t[0]);return i<a?r.helpers.format(r.settings.messages.MIN,a):null}static max(e,s,t,r){const i=r.helpers.getValue(s);if(!r.helpers.isInteger(i))return r.settings.messages.INTEGER;const a=Number(t[0]);return a<i?r.helpers.format(r.settings.messages.MIN,a):null}static range(e,s,t,r){const i=r.helpers.getValue(s);if(!r.helpers.isInteger(i))return r.settings.messages.INTEGER;const a=Number(t[0]),n=Number(t[1]);return i<a||n<i?r.helpers.format(r.settings.messages.RANGE,a,n):null}static date(e,s,t,r){return r.helpers.getValue(s).match(/^((\d{1,4})[/-](\d{1,2})[/-](\d{1,2}))$/g)?r.helpers.isDate(RegExp.$2,RegExp.$3,RegExp.$4)?null:r.settings.messages.DATE_INVALID:r.settings.messages.DATE}static datetime(e,s,t,r){return r.helpers.getValue(s).match(/^((\d{1,4})[/-](\d{1,2})[/-](\d{1,2}))( ((\d{1,2}):(\d{1,2})(:(\d{1,2}))?))?$/g)?r.helpers.isDate(RegExp.$2,RegExp.$3,RegExp.$4)?RegExp.$6&&!r.helpers.isTime(RegExp.$7,RegExp.$8,RegExp.$10)?r.settings.messages.TIME_INVALID:null:r.settings.messages.DATE_INVALID:r.settings.messages.DATETIME}static date_ex(e,s,t,r){if(!r.helpers.getValue(s).match(/^(\d{1,4})([/-](\d{1,2})([/-](\d{1,2}))?)?$/))return r.settings.messages.DATE_EX;const i=RegExp.$1,a=RegExp.$3?RegExp.$3:1,n=RegExp.$5?RegExp.$5:1;return r.helpers.isDate(i,a,n)?null:r.settings.messages.DATE_INVALID}static time(e,s,t,r){const i=r.helpers.getValue(s);if("hm"===t[0]){if(!i.match(/^(\d{1,2}):(\d{1,2})$/g))return r.settings.messages.TIME_HM;if(!r.helpers.isTime(RegExp.$1,RegExp.$2,0))return r.settings.messages.TIME_INVALID}else{if(!i.match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/g))return r.settings.messages.TIME;if(!r.helpers.isTime(RegExp.$1,RegExp.$2,RegExp.$3))return r.settings.messages.TIME_INVALID}return null}static zip(e,s,t,r){return r.helpers.getValue(s).match(/^\d{1,3}-\d{1,4}$/g)?null:r.settings.messages.ZIP}static regexp(e,s,t,r){const i=r.helpers.getValue(s);let a,n;Array.isArray(t)||(t=[t]);try{if("string"==typeof t[0]?(a=new RegExp(t[0],t[1]?t[1]:void 0),n=t[2]):(a=t[0],n=t[1]),!a.test(i))return n||r.settings.messages.REGEXP_INVALID_VALUE}catch(e){return r.settings.messages.REGEXP_INVALID_PARAM}return null}}class a{static numeric(e,s,t,r){return s&&s[0].validity&&s[0].validity.badInput?s[0].validationMessage:null}static checkbox(e,s,t,r){const i=r.helpers.getValue(s).length,a=Number(t[0]);if(t.length>=2){const e=Number(t[1]);if(i<a||e<i)return r.helpers.format(r.settings.messages.CHECKBOX_RANGE,a,e)}else if(i<a)return r.helpers.format(r.settings.messages.CHECKBOX_MIN,a)}static zip_ex(e,s,t,r){const i=r.querySelectorByName(e.name+r.settings.zip_suffix);return!r.helpers.existsValue(s)&&r.helpers.existsValue(i)?r.settings.messages.INSUFFICIENT:null}static ymd(e,s,t,r){const i=[];let a=null,n=null,l=null,u=!1,h=!1,o=!1;const g=r.querySelectorByName(e.name+r.settings.ymd_suffix_y),c=r.querySelectorByName(e.name+r.settings.ymd_suffix_m),m=r.querySelectorByName(e.name+r.settings.ymd_suffix_d);return r.helpers.existsValue(g)&&(u=!0,a=r.helpers.getValue(g)),r.helpers.existsValue(c)&&(h=!0,n=r.helpers.getValue(c)),r.helpers.existsValue(m)&&(o=!0,l=r.helpers.getValue(m)),"required"===t[0]?(u||i.push(r.helpers.format(r.settings.messages.REQUIRED_PART,r.settings.messages.DATE_PART_Y)),h||i.push(r.helpers.format(r.settings.messages.REQUIRED_PART,r.settings.messages.DATE_PART_M)),o||i.push(r.helpers.format(r.settings.messages.REQUIRED_PART,r.settings.messages.DATE_PART_D))):!(u||h||o)||u&&h&&o||(u||i.push(r.helpers.format(r.settings.messages.INSUFFICIENT_PART,r.settings.messages.DATE_PART_Y)),h||i.push(r.helpers.format(r.settings.messages.INSUFFICIENT_PART,r.settings.messages.DATE_PART_M)),o||i.push(r.helpers.format(r.settings.messages.INSUFFICIENT_PART,r.settings.messages.DATE_PART_D))),u&&!r.helpers.isInteger(a)&&i.push(r.helpers.format(r.settings.messages.INTEGER_PART,r.settings.messages.DATE_PART_Y)),h&&!r.helpers.isInteger(n)&&i.push(r.helpers.format(r.settings.messages.INTEGER_PART,r.settings.messages.DATE_PART_M)),o&&!r.helpers.isInteger(l)&&i.push(r.helpers.format(r.settings.messages.INTEGER_PART,r.settings.messages.DATE_PART_D)),0!==i.length||r.helpers.isDate(a,n,l)||i.push(r.helpers.format(r.settings.messages.DATE_INVALID)),i}}class n{constructor(e,s){if(this.form=e,this._settings={submit:"validate",result:null,confirm_suffix:"_confirm",zip_suffix:"_after",ymd_suffix_y:"_y",ymd_suffix_m:"_m",ymd_suffix_d:"_d",setError:null,clearError:null,focusError:!1,messages:t},s){s.fields&&(this.fields=s.fields);for(const e in this._settings)s[e]&&("object"==typeof s[e]?this._settings[e]=Object.assign(this._settings[e],s[e]):this._settings[e]=s[e])}this.helpers=r,this._validRules=a,this._validExistsRules=i,this.listenerSubmit=e=>this.onSubmit(e),this.form.addEventListener("submit",this.listenerSubmit)}destroy(){this.form.removeEventListener("submit",this.listenerSubmit),this.settings.submit=null}onSubmit(e){let s=!1;this.settings.submit&&("string"==typeof this.settings.submit?-1!==["validate","validateAlert","asyncValidate","asyncValidateAlert"].indexOf(this.settings.submit)?s=this[this.settings.submit]():console.error("Not exists method ["+this.settings.submit+"]"):"function"==typeof this.settings.submit&&(s=this.settings.submit()),s||e.preventDefault())}get form(){return this._form}set form(e){this._form="string"==typeof e?document.querySelector(e):e}get settings(){return this._settings}set settings(e){this._settings=Object.assign(this._settings,e)}querySelectorByName(e){const s=this.form.querySelectorAll('*[name="'+e+'"]');return s||console.error("Not found element "+e+"."),s}displayError(e){e.forEach((e=>{this.setError(e.name,e.message)})),e.length>0&&this.focusError(e[0].name)}focusError(e){const s=this.querySelectorByName(e);s&&s.length>0?s[0].focus():console.warn(this.helpers.format(this.settings.messages.NOT_EXISTS_FIELD,e))}clearError(e){"function"==typeof this.settings.clearError?this.settings.clearError(e):this.clearErrorBootstrap(e)}setError(e,s){"function"==typeof this.settings.setError?this.settings.setError.apply(this,[e,s]):this.setErrorBootstrap(e,s)}clearErrorBootstrap(e){if(e){const s=this.querySelectorByName(e)[0],t=s.attributes.type?s.attributes.type.value:null;if(-1!==["radio","checkbox"].indexOf(t)){const e=s.parentNode.parentNode;e.querySelectorAll(".is-invalid").forEach((e=>e.classList.remove("is-invalid"))),e.querySelectorAll(".invalid-feedback").forEach((e=>e.remove()))}else this.form.querySelectorAll("*[name='"+e+"'].is-invalid").forEach((e=>e.classList.remove("is-invalid"))),this.form.querySelectorAll("*[name='"+e+"'] ~ .invalid-feedback").forEach((e=>e.remove()))}else this.form.querySelectorAll(".is-invalid").forEach((e=>e.classList.remove("is-invalid"))),this.form.querySelectorAll(".invalid-feedback").forEach((e=>e.remove()))}setErrorBootstrap(e,s){const t=document.createElement("div");t.innerHTML='<div class="invalid-feedback">'+s+"</div>";const r=this.querySelectorByName(e),i=r[0],a=i.attributes.type?i.attributes.type.value:null;if(-1!==["radio","checkbox"].indexOf(a)){r.forEach((e=>e.classList.add("is-invalid")));const e=i.parentNode;e.classList.add("is-invalid"),e.parentNode.insertBefore(t.firstElementChild,null)}else i.classList.add("is-invalid"),i.parentNode.insertBefore(t.firstElementChild,null)}_validateCommon(e){let s=!0;return e.length>0&&(this.displayError(e),s=!1),"function"==typeof this.settings.result&&(s=this.settings.result(s,e)),s}validate(e){return this.clearError(),this._validateCommon(this.getValidateResult(e))}async asyncValidate(e){return this.clearError(),this.asyncGetValidateResult(e).then((e=>this._validateCommon(e)))}_validateAlertCommon(e){let s=!0;return e.length>0&&(window.alert(this.settings.messages.VALIDATE_ERROR+"\n"+this.helpers.join(e)),this.settings.focusError?this.settings.focusError.apply(e[0].name):this.focusError(e[0].name),s=!1),"function"==typeof this.settings.result&&(s=this.settings.result(s,e)),s}validateAlert(e){return this._validateAlertCommon(this.getValidateResult(e))}async asyncValidateAlert(e){return await this.asyncGetValidateResult(e).then((e=>this._validateAlertCommon(e)))}getFieldsRules(){const e=[];return Array.from(this.form).forEach((s=>{const t=s.name;if(!t)return;const r=s.getAttribute("type");if(("radio"===r||"checkbox"===r)&&e.find((e=>e.name===s.name)))return;const i=[];let a;switch(s.required&&i.push("required"),[["minLength","minlength"],["maxLength","maxlength"],"min","max",["pattern","regexp"]].forEach((function(e){let t;Array.isArray(e)?(t=e[1],e=e[0]):t=e;const r=s.getAttribute(e);null!==r&&i.push([t,r])})),r){case"date":case"email":case"tel":a=r;break;case"number":a="numeric";break;case"time":a=["time","hm"]}a&&i.push(a),e.push({name:t,rules:i})})),e}_parseRule(e){let s;if(Array.isArray(e)){if(0===e.length)return null;2===e.length?(s=e[1],Array.isArray(s)||(s=[s])):e.length>=3&&(s=e.slice(1)),e=e[0]}else if("object"==typeof e){if(!e.rule)return null;e.params&&(s=e.params,Array.isArray(s)||(s=[s])),e=e.rule}else if("string"==typeof e)if(s=e.split(":",2),s[0]&&(e=s[0]),s[1]){try{s=JSON.parse(s[1])}catch(e){s=s[1].split(",")}Array.isArray(s)||(s=[s])}else s=[];return[e,s]}_validateRule(e,s,t,r){let i;return"function"==typeof e?i=e.apply(this,[s,t,r,this]):this.helpers.existsValue(t)?"function"==typeof this._validExistsRules[e]?i=this._validExistsRules[e].apply(this,[s,t,r,this]):"checkbox"===e&&(i=this._validRules[e].apply(this,[s,t,r,this])):"required"===e?this.helpers.existsValue(t)||(i=this.settings.messages.REQUIRED):"function"==typeof this._validRules[e]&&(i=this._validRules[e].apply(this,[s,t,r,this])),i}getValidateResult(e){const s=e&&e.fields?e.fields:this.fields||this.getFieldsRules(),t=[];return s.forEach((e=>{const s=this.querySelectorByName(e.name);if(!e.rules)return;let r=e.rules;Array.isArray(r)||(r=[r]),r.forEach((r=>{let i;[r,i]=this._parseRule(r);const a=this._validateRule(r,e,s,i);this.helpers.pushErrors(t,e,a)}))})),t}async asyncGetValidateResult(e){const s=e&&e.fields?e.fields:this.fields||this.getFieldsRules(),t=[],r=[];for(const e of s){const s=this.querySelectorByName(e.name);if(!e.rules)break;let i=e.rules;Array.isArray(i)||(i=[i]),i.forEach((i=>{let a;[i,a]=this._parseRule(i);const n=this._validateRule(i,e,s,a);null!=n&&(t.push("function"==typeof n.then?n:Promise.resolve(n)),r.push(e))}))}return await Promise.all(t).then((e=>{const s=[];for(const t in e)this.helpers.pushErrors(s,r[t],e[t]);return s}))}}var l=s.I;export{l as BootstrapValidator};
//# sourceMappingURL=bootstrap-validator.esm.min.js.map